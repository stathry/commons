package em;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import org.apache.commons.io.FileUtils;
import org.apache.commons.lang3.StringUtils;
import org.junit.Test;
import org.springframework.util.ResourceUtils;
import org.stathry.commons.utils.DistributeIdUtils;

import java.io.File;
import java.io.IOException;
import java.text.MessageFormat;
import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.LocalTime;
import java.time.format.DateTimeFormatter;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;
import java.util.TreeSet;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.stream.Collectors;

/**
 * IdTest
 *
 * @author dongdaiming(董代明)
 * @date 2019-04-17 18:09
 */
public class IdTest {

    @Test
    public void testUpdateAmount() {
        JSONArray array = JSON.parseArray("[{\"amount_paid\":\"0\",\"amount_received\":\"8\",\"amount_receivable\":\"8\",\"order_id\":\"376266638229664\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"12\",\"amount_receivable\":\"12\",\"order_id\":\"376266655268944\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"16\",\"amount_receivable\":\"99\",\"order_id\":\"376266793418816\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376266801807568\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"10\",\"amount_receivable\":\"10\",\"order_id\":\"376267032756432\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"40\",\"amount_receivable\":\"99\",\"order_id\":\"376267053466000\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376267187683432\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267317706856\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"8\",\"amount_receivable\":\"99\",\"order_id\":\"376267464769552\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"18\",\"amount_receivable\":\"99\",\"order_id\":\"376267590336712\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"3\",\"amount_receivable\":\"3\",\"order_id\":\"376267590598696\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"18\",\"amount_receivable\":\"18\",\"order_id\":\"376267607114040\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"14\",\"amount_receivable\":\"14\",\"order_id\":\"376267636736088\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"18\",\"amount_receivable\":\"18\",\"order_id\":\"376267653513432\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267657707712\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"18\",\"amount_receivable\":\"99\",\"order_id\":\"376267661902040\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"8\",\"amount_receivable\":\"8\",\"order_id\":\"376267690999840\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"1.5\",\"amount_receivable\":\"1.5\",\"order_id\":\"376267875549352\",\"amount_payable\":\"99\"},{\"amount_paid\":\"20\",\"amount_received\":\"99\",\"amount_receivable\":\"99\",\"order_id\":\"376082994824809\",\"amount_payable\":\"20\"},{\"amount_paid\":\"0\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376266634297953\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"3\",\"amount_receivable\":\"3\",\"order_id\":\"376266651074841\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"9\",\"amount_receivable\":\"99\",\"order_id\":\"376266659463305\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"8\",\"amount_receivable\":\"8\",\"order_id\":\"376266713727281\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"20\",\"amount_receivable\":\"20\",\"order_id\":\"376266789486593\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"15\",\"amount_receivable\":\"15\",\"order_id\":\"376266827235577\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"37.5\",\"amount_receivable\":\"37.5\",\"order_id\":\"376266873110697\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376266898276425\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267049271921\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"1\",\"amount_receivable\":\"1\",\"order_id\":\"376267200266257\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"1\",\"amount_receivable\":\"1\",\"order_id\":\"376267217043841\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"1.5\",\"amount_receivable\":\"99\",\"order_id\":\"376267250860433\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"15\",\"amount_receivable\":\"15\",\"order_id\":\"376267258986529\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267330290137\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"30\",\"amount_receivable\":\"30\",\"order_id\":\"376267489673225\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"16.5\",\"amount_receivable\":\"16.5\",\"order_id\":\"376267531616281\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"3\",\"amount_receivable\":\"3\",\"order_id\":\"376267582210081\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"1.5\",\"amount_receivable\":\"1.5\",\"order_id\":\"376267703845161\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"1.5\",\"amount_receivable\":\"1.5\",\"order_id\":\"376267804246033\",\"amount_payable\":\"0\"},{\"amount_paid\":\"20.5\",\"amount_received\":\"22.5\",\"amount_receivable\":\"22.5\",\"order_id\":\"376155749221122\",\"amount_payable\":\"22.5\"},{\"amount_paid\":\"99\",\"amount_received\":\"20\",\"amount_receivable\":\"99\",\"order_id\":\"376266692755530\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"14\",\"amount_receivable\":\"14\",\"order_id\":\"376266743349306\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"21\",\"amount_receivable\":\"21\",\"order_id\":\"376266789224546\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376266823041442\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4.5\",\"amount_receivable\":\"4.5\",\"order_id\":\"376266877305266\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"10\",\"amount_receivable\":\"10\",\"order_id\":\"376267015979434\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"30\",\"amount_receivable\":\"30\",\"order_id\":\"376267091214530\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"99\",\"order_id\":\"376267158585482\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"1.5\",\"amount_receivable\":\"1.5\",\"order_id\":\"376267175362986\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376267217043618\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"3\",\"amount_receivable\":\"3\",\"order_id\":\"376267221238234\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"10\",\"amount_receivable\":\"10\",\"order_id\":\"376267267375850\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267384816074\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"1.5\",\"amount_receivable\":\"1.5\",\"order_id\":\"376267406049402\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"9\",\"amount_receivable\":\"9\",\"order_id\":\"376267489673674\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267540267034\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"10\",\"amount_receivable\":\"10\",\"order_id\":\"376267573821938\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"3\",\"amount_receivable\":\"3\",\"order_id\":\"376267716166298\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"99\",\"order_id\":\"376267838063050\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"1.5\",\"amount_receivable\":\"1.5\",\"order_id\":\"376267854577850\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267859034178\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"1\",\"amount_receivable\":\"1\",\"order_id\":\"376266717921507\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376266889887851\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"15\",\"amount_receivable\":\"15\",\"order_id\":\"376266931830971\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376266932093203\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376266940219635\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"8\",\"amount_receivable\":\"8\",\"order_id\":\"376267024105587\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"3\",\"amount_receivable\":\"99\",\"order_id\":\"376267032494195\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267154391539\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267162780019\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267183489275\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"18\",\"amount_receivable\":\"18\",\"order_id\":\"376267225432227\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"30\",\"amount_receivable\":\"30\",\"order_id\":\"376267364106395\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"99\",\"order_id\":\"376267401592923\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"15\",\"amount_receivable\":\"99\",\"order_id\":\"376267485479035\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376267498062243\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"7.5\",\"amount_receivable\":\"7.5\",\"order_id\":\"376267527422211\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376267716166011\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267758108963\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267779342851\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"60\",\"amount_receivable\":\"99\",\"order_id\":\"375138794340620\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"20\",\"amount_receivable\":\"20\",\"order_id\":\"376073700249380\",\"amount_payable\":\"0\"},{\"amount_paid\":\"4\",\"amount_received\":\"99\",\"amount_receivable\":\"99\",\"order_id\":\"376250209140740\",\"amount_payable\":\"4\"},{\"amount_paid\":\"99\",\"amount_received\":\"3\",\"amount_receivable\":\"3\",\"order_id\":\"376266671783972\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"12\",\"amount_receivable\":\"99\",\"order_id\":\"376266743349548\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"9\",\"amount_receivable\":\"9\",\"order_id\":\"376266806264012\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"5\",\"amount_receivable\":\"5\",\"order_id\":\"376266936287468\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"38\",\"amount_receivable\":\"99\",\"order_id\":\"376266948608228\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376266957258964\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"99\",\"order_id\":\"376266990813244\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"99\",\"order_id\":\"376267032756652\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"30\",\"amount_receivable\":\"99\",\"order_id\":\"376267041144996\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"1.5\",\"amount_receivable\":\"1.5\",\"order_id\":\"376267049271580\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267112186084\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"99\",\"order_id\":\"376267254792436\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267263181148\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"12\",\"amount_receivable\":\"12\",\"order_id\":\"376267267375476\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376267267376292\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"99\",\"order_id\":\"376267338678428\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"99\",\"order_id\":\"376267368300908\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267376427116\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"20\",\"amount_receivable\":\"99\",\"order_id\":\"376267385077924\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"3\",\"amount_receivable\":\"3\",\"order_id\":\"376267422827300\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"1\",\"amount_receivable\":\"1\",\"order_id\":\"376267493867972\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"99\",\"order_id\":\"376267581947948\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"99\",\"order_id\":\"376267598725212\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"7.5\",\"amount_receivable\":\"7.5\",\"order_id\":\"376267687067844\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267703582788\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"7.5\",\"amount_receivable\":\"99\",\"order_id\":\"376267817091100\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"99\",\"order_id\":\"376267829412028\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"8\",\"amount_receivable\":\"8\",\"order_id\":\"376266659201101\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376266663657997\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376266709532677\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"99\",\"order_id\":\"376266718183869\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"14\",\"amount_receivable\":\"99\",\"order_id\":\"376266831429709\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"5.5\",\"amount_receivable\":\"5.5\",\"order_id\":\"376266835623957\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"99\",\"order_id\":\"376266844012941\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"8\",\"amount_receivable\":\"99\",\"order_id\":\"376266864722005\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376266864722213\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376266919247957\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"30\",\"amount_receivable\":\"30\",\"order_id\":\"376266927898773\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376266969579621\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"99\",\"order_id\":\"376266990813781\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"30\",\"amount_receivable\":\"99\",\"order_id\":\"376266994745437\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4.5\",\"amount_receivable\":\"4.5\",\"order_id\":\"376267091214677\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"10\",\"amount_receivable\":\"10\",\"order_id\":\"376267104059533\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"4.5\",\"amount_receivable\":\"4.5\",\"order_id\":\"376267171168493\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"9\",\"amount_receivable\":\"9\",\"order_id\":\"376267196072325\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267204460629\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"16\",\"amount_receivable\":\"99\",\"order_id\":\"376267271569477\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"3\",\"amount_receivable\":\"3\",\"order_id\":\"376267271831741\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"18\",\"amount_receivable\":\"18\",\"order_id\":\"376267430952997\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267544461349\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"14\",\"amount_receivable\":\"14\",\"order_id\":\"376267552587989\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"1\",\"amount_receivable\":\"1\",\"order_id\":\"376267560976829\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"10.5\",\"amount_receivable\":\"10.5\",\"order_id\":\"376267707777141\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267716165765\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"5\",\"amount_receivable\":\"99\",\"order_id\":\"376267724816605\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267729010717\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"12\",\"amount_receivable\":\"12\",\"order_id\":\"376267833868301\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"7.5\",\"amount_receivable\":\"99\",\"order_id\":\"376267871617037\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376266625908774\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"20\",\"amount_receivable\":\"20\",\"order_id\":\"376266671784662\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376266676240838\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"99\",\"order_id\":\"376266793419606\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"5\",\"amount_receivable\":\"99\",\"order_id\":\"376266823041222\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"12\",\"amount_receivable\":\"12\",\"order_id\":\"376266852139022\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"21\",\"amount_receivable\":\"21\",\"order_id\":\"376266919510214\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376266932093166\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"1\",\"amount_receivable\":\"99\",\"order_id\":\"376266936025142\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"99\",\"order_id\":\"376266977968582\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267003133982\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"10\",\"amount_receivable\":\"10\",\"order_id\":\"376267019911526\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376267024367726\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"7.5\",\"amount_receivable\":\"7.5\",\"order_id\":\"376267255054542\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376267288609078\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267317969006\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267330289854\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"15\",\"amount_receivable\":\"99\",\"order_id\":\"376267342872758\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267347329094\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"3\",\"amount_receivable\":\"99\",\"order_id\":\"376267351261518\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"20\",\"amount_receivable\":\"20\",\"order_id\":\"376267355456494\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"16\",\"amount_receivable\":\"16\",\"order_id\":\"376267414438022\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267674222774\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376267745787982\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"2\",\"amount_receivable\":\"2\",\"order_id\":\"376267758109318\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"7.5\",\"amount_receivable\":\"99\",\"order_id\":\"376267825217934\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"5\",\"amount_receivable\":\"5\",\"order_id\":\"376267879743550\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4.5\",\"amount_receivable\":\"4.5\",\"order_id\":\"376266608869447\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"14\",\"amount_receivable\":\"14\",\"order_id\":\"376266634035463\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"16\",\"amount_receivable\":\"16\",\"order_id\":\"376266676240503\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"27.5\",\"amount_receivable\":\"27.5\",\"order_id\":\"376266713727183\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"1.5\",\"amount_receivable\":\"1.5\",\"order_id\":\"376266793419423\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376266877304919\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"7.5\",\"amount_receivable\":\"99\",\"order_id\":\"376266889888223\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"10\",\"amount_receivable\":\"10\",\"order_id\":\"376266940219719\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"4.5\",\"amount_receivable\":\"4.5\",\"order_id\":\"376266952802455\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"3\",\"amount_receivable\":\"3\",\"order_id\":\"376267057660151\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"12\",\"amount_receivable\":\"12\",\"order_id\":\"376267082825983\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"12\",\"amount_receivable\":\"12\",\"order_id\":\"376267133419671\",\"amount_payable\":\"99\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267137613847\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"3\",\"amount_receivable\":\"3\",\"order_id\":\"376267166974599\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267296735711\",\"amount_payable\":\"99\"},{\"amount_paid\":\"0\",\"amount_received\":\"6\",\"amount_receivable\":\"6\",\"order_id\":\"376267397398559\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"10.5\",\"amount_receivable\":\"10.5\",\"order_id\":\"376267422826711\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"7.5\",\"amount_receivable\":\"7.5\",\"order_id\":\"376267431215335\",\"amount_payable\":\"0\"},{\"amount_paid\":\"0\",\"amount_received\":\"8\",\"amount_receivable\":\"8\",\"order_id\":\"376267510907079\",\"amount_payable\":\"0\"},{\"amount_paid\":\"99\",\"amount_received\":\"4\",\"amount_receivable\":\"4\",\"order_id\":\"376267862966343\",\"amount_payable\":\"99\"}]");
        System.out.println(array.size());
        String sql = "update ord_{0}.t_ord_order set amount_payable = {1}, amount_paid = {2}, gmt_modify =now() where id = {3} and amount_paid != {4};";
        for (int i = 0; i < array.size(); i++) {
            JSONObject jsonObject = array.getJSONObject(i);
            Long id = jsonObject.getLong("order_id");
            System.out.println(MessageFormat.format(sql, id % 8, jsonObject.getBigDecimal("amount_receivable"),
                    jsonObject.getBigDecimal("amount_received"), id.toString(), jsonObject.getBigDecimal("amount_received")
                    ));
        }
    }

    @Test
    public void testDelCol() throws IOException {
        JSONArray array = JSON.parseArray("[{\"orderId\":\"374456624087456\",\"id\":\"376269338329091\"},{\"orderId\":\"376043568367928\",\"id\":\"376435470520327\"},{\"orderId\":\"376066347896960\",\"id\":\"376438372974597\"},{\"orderId\":\"376087797304632\",\"id\":\"376438372978692\"},{\"orderId\":\"376092243528088\",\"id\":\"376438372978693\"},{\"orderId\":\"376120189913832\",\"id\":\"376438377173007\"},{\"orderId\":\"376137235825056\",\"id\":\"376346031181827\"},{\"orderId\":\"376143770288440\",\"id\":\"376438381367312\"},{\"orderId\":\"376149474543072\",\"id\":\"376438381363208\"},{\"orderId\":\"376150720513136\",\"id\":\"376438385561605\"},{\"orderId\":\"376158891016560\",\"id\":\"376438385557524\"},{\"orderId\":\"376159071109552\",\"id\":\"376375840100353\"},{\"orderId\":\"376159649923664\",\"id\":\"376270420463620\"},{\"orderId\":\"376160379732304\",\"id\":\"376438389755910\"},{\"orderId\":\"376162363638424\",\"id\":\"376438389755912\"},{\"orderId\":\"376169510994360\",\"id\":\"376438393950223\"},{\"orderId\":\"376172728025560\",\"id\":\"376438398144512\"},{\"orderId\":\"376177911923008\",\"id\":\"376438398140434\"},{\"orderId\":\"376178239079360\",\"id\":\"376438402338820\"},{\"orderId\":\"376181070234104\",\"id\":\"376438402338824\"},{\"orderId\":\"376183343547304\",\"id\":\"376438406529027\"},{\"orderId\":\"376188573844216\",\"id\":\"376438406529032\"},{\"orderId\":\"376199147946072\",\"id\":\"376438406529050\"},{\"orderId\":\"376201769124424\",\"id\":\"376438410723331\"},{\"orderId\":\"376205393002592\",\"id\":\"376438410723351\"},{\"orderId\":\"376205837599080\",\"id\":\"376438410727437\"},{\"orderId\":\"376207238758616\",\"id\":\"376438414917641\"},{\"orderId\":\"376211344982160\",\"id\":\"376438414917649\"},{\"orderId\":\"376218881884640\",\"id\":\"376438419111940\"},{\"orderId\":\"376226343551584\",\"id\":\"376438423310336\"},{\"orderId\":\"376228025467000\",\"id\":\"376438423310337\"},{\"orderId\":\"376229124637120\",\"id\":\"376422644334599\"},{\"orderId\":\"376230378733720\",\"id\":\"376438423306249\"},{\"orderId\":\"376234375905432\",\"id\":\"376438427500555\"},{\"orderId\":\"376237861109784\",\"id\":\"376438427504655\"},{\"orderId\":\"376241904681376\",\"id\":\"376438431694856\"},{\"orderId\":\"376246832726712\",\"id\":\"376438431694865\"},{\"orderId\":\"376250905395256\",\"id\":\"376399391117314\"},{\"orderId\":\"376259415638192\",\"id\":\"376438440083456\"},{\"orderId\":\"376267238015096\",\"id\":\"376438444281865\"},{\"orderId\":\"376089752111769\",\"id\":\"376438452670466\"},{\"orderId\":\"376101906941929\",\"id\":\"376438452670480\"},{\"orderId\":\"376104268596393\",\"id\":\"376438456864768\"},{\"orderId\":\"376112052964353\",\"id\":\"376438456864770\"},{\"orderId\":\"376123155546473\",\"id\":\"376438456860681\"},{\"orderId\":\"376123495286993\",\"id\":\"376438456864783\"},{\"orderId\":\"376133620073033\",\"id\":\"376438461059086\"},{\"orderId\":\"376135692323737\",\"id\":\"376438465249281\"},{\"orderId\":\"376139240440361\",\"id\":\"376438465249288\"},{\"orderId\":\"376146941182993\",\"id\":\"376438465249301\"},{\"orderId\":\"376148312983209\",\"id\":\"376438469447681\"},{\"orderId\":\"376149621607369\",\"id\":\"376438469447685\"},{\"orderId\":\"376151374823921\",\"id\":\"376267119546371\"},{\"orderId\":\"376152591171713\",\"id\":\"376438469447692\"},{\"orderId\":\"376159004000825\",\"id\":\"376438473637895\"},{\"orderId\":\"376171742101745\",\"id\":\"376438477836288\"},{\"orderId\":\"376172799329601\",\"id\":\"376438477836293\"},{\"orderId\":\"376172853593449\",\"id\":\"376438477832197\"},{\"orderId\":\"376174883897689\",\"id\":\"376438477832199\"},{\"orderId\":\"376175923822673\",\"id\":\"376438477836298\"},{\"orderId\":\"376201039577681\",\"id\":\"376439857758217\"},{\"orderId\":\"376206223475353\",\"id\":\"376439861952513\"},{\"orderId\":\"376208811623289\",\"id\":\"376439861952523\"},{\"orderId\":\"376210959106097\",\"id\":\"376439866146816\"},{\"orderId\":\"376214729524105\",\"id\":\"376439866146819\"},{\"orderId\":\"376216868880873\",\"id\":\"376439866146823\"},{\"orderId\":\"376222132732153\",\"id\":\"376439870345217\"},{\"orderId\":\"376227740516593\",\"id\":\"376270344962050\"},{\"orderId\":\"376231028588729\",\"id\":\"376439870345239\"},{\"orderId\":\"376233427993033\",\"id\":\"376439874535428\"},{\"orderId\":\"376234014933465\",\"id\":\"376439874539526\"},{\"orderId\":\"376235332207249\",\"id\":\"376439874535431\"},{\"orderId\":\"376236590497841\",\"id\":\"376270219137024\"},{\"orderId\":\"376241354965417\",\"id\":\"376439878729736\"},{\"orderId\":\"376245260124161\",\"id\":\"376439882924041\"},{\"orderId\":\"376251706769529\",\"id\":\"376439887118342\"},{\"orderId\":\"376253657121001\",\"id\":\"376439887122444\"},{\"orderId\":\"376253858185721\",\"id\":\"376439887122446\"},{\"orderId\":\"376257675001929\",\"id\":\"376439891316739\"},{\"orderId\":\"376258723578017\",\"id\":\"376439891312645\"},{\"orderId\":\"376259160047665\",\"id\":\"376439891312650\"},{\"orderId\":\"376262376817009\",\"id\":\"376439891316746\"},{\"orderId\":\"376267015717001\",\"id\":\"376439895511046\"},{\"orderId\":\"375135732236826\",\"id\":\"376269334134785\"},{\"orderId\":\"376037918901746\",\"id\":\"376439895511060\"},{\"orderId\":\"376075973821058\",\"id\":\"376439899705351\"},{\"orderId\":\"376081636135690\",\"id\":\"376439899701262\"},{\"orderId\":\"376101051302994\",\"id\":\"376439903895556\"},{\"orderId\":\"376112220734530\",\"id\":\"376439903899660\"},{\"orderId\":\"376115760726266\",\"id\":\"376439908093955\"},{\"orderId\":\"376130314961618\",\"id\":\"376439908093968\"},{\"orderId\":\"376135767557826\",\"id\":\"376439908089871\"},{\"orderId\":\"376157884383794\",\"id\":\"376439912288263\"},{\"orderId\":\"376159465636538\",\"id\":\"376439916478468\"},{\"orderId\":\"376172094423818\",\"id\":\"376439920676882\"},{\"orderId\":\"376173743048962\",\"id\":\"376439920676883\"},{\"orderId\":\"376197881004114\",\"id\":\"376439929065473\"},{\"orderId\":\"376199307329578\",\"id\":\"376439929065476\"},{\"orderId\":\"376202796990938\",\"id\":\"376439929061388\"},{\"orderId\":\"376203543576930\",\"id\":\"376439929065484\"},{\"orderId\":\"376212082918138\",\"id\":\"376439933259780\"},{\"orderId\":\"376213823815922\",\"id\":\"376439933255693\"},{\"orderId\":\"376225034928546\",\"id\":\"376439937449997\"},{\"orderId\":\"376231175389218\",\"id\":\"376439941648385\"},{\"orderId\":\"376239438430666\",\"id\":\"376439941644308\"},{\"orderId\":\"376240302456914\",\"id\":\"376439945838592\"},{\"orderId\":\"376242785222746\",\"id\":\"376439945842701\"},{\"orderId\":\"376250427506930\",\"id\":\"376439950032904\"},{\"orderId\":\"376252549824650\",\"id\":\"376439954227202\"},{\"orderId\":\"376264583020658\",\"id\":\"376439954231310\"},{\"orderId\":\"376267560976570\",\"id\":\"376439958421512\"},{\"orderId\":\"375135828706267\",\"id\":\"376269338333192\"},{\"orderId\":\"376101429053011\",\"id\":\"376439962615817\"},{\"orderId\":\"376104381843115\",\"id\":\"376271347404800\"},{\"orderId\":\"376107456006347\",\"id\":\"376439962619920\"},{\"orderId\":\"376108680743235\",\"id\":\"376439966810113\"},{\"orderId\":\"376119556833691\",\"id\":\"376439966810116\"},{\"orderId\":\"376131216738331\",\"id\":\"376439971008514\"},{\"orderId\":\"376131728703763\",\"id\":\"376439971004425\"},{\"orderId\":\"376144529458691\",\"id\":\"376439975198727\"},{\"orderId\":\"376160665206995\",\"id\":\"376439979397135\"},{\"orderId\":\"376161889945083\",\"id\":\"376439983591426\"},{\"orderId\":\"376163911599307\",\"id\":\"376439983591430\"},{\"orderId\":\"376169011873147\",\"id\":\"376439983587339\"},{\"orderId\":\"376175185625763\",\"id\":\"376439987785732\"},{\"orderId\":\"376181515093979\",\"id\":\"376439987781645\"},{\"orderId\":\"376192122486835\",\"id\":\"376439991980037\"},{\"orderId\":\"376214691774859\",\"id\":\"376439996170254\"},{\"orderId\":\"376217011224827\",\"id\":\"376439996174351\"},{\"orderId\":\"376219557167355\",\"id\":\"376439996174357\"},{\"orderId\":\"376225483980899\",\"id\":\"376440000364551\"},{\"orderId\":\"376237328433627\",\"id\":\"376440004558854\"},{\"orderId\":\"376237785874715\",\"id\":\"376267035660290\"},{\"orderId\":\"376239295824235\",\"id\":\"376440004562951\"},{\"orderId\":\"376240159588691\",\"id\":\"376440004562954\"},{\"orderId\":\"376240709304755\",\"id\":\"376440004562956\"},{\"orderId\":\"376244421001315\",\"id\":\"376440008757252\"},{\"orderId\":\"376246157705459\",\"id\":\"376440008757259\"},{\"orderId\":\"376246224814187\",\"id\":\"376440008757263\"},{\"orderId\":\"376248200069275\",\"id\":\"376440012951553\"},{\"orderId\":\"376250339426307\",\"id\":\"376440012947458\"},{\"orderId\":\"376251106984427\",\"id\":\"376440012951561\"},{\"orderId\":\"376251203453659\",\"id\":\"376440012951567\"},{\"orderId\":\"376253359325227\",\"id\":\"376440012947467\"},{\"orderId\":\"376254508302507\",\"id\":\"376440012947471\"},{\"orderId\":\"376255917850859\",\"id\":\"376440012947472\"},{\"orderId\":\"376255930433835\",\"id\":\"376440017141762\"},{\"orderId\":\"376258589622363\",\"id\":\"376440017145864\"},{\"orderId\":\"376259764027563\",\"id\":\"376440017141774\"},{\"orderId\":\"376264591671315\",\"id\":\"376440444960772\"},{\"orderId\":\"376266055221427\",\"id\":\"376440444960792\"},{\"orderId\":\"376266478846451\",\"id\":\"376440449155073\"},{\"orderId\":\"376266604937523\",\"id\":\"376440449159173\"},{\"orderId\":\"376045628032276\",\"id\":\"376440449155091\"},{\"orderId\":\"376084844512364\",\"id\":\"376440453353482\"},{\"orderId\":\"376111067565804\",\"id\":\"376440453349384\"},{\"orderId\":\"376113395403860\",\"id\":\"376440453353488\"},{\"orderId\":\"376113919691668\",\"id\":\"376440457543685\"},{\"orderId\":\"376115714590836\",\"id\":\"376440457547790\"},{\"orderId\":\"376121075173612\",\"id\":\"376440461737986\"},{\"orderId\":\"376131145696348\",\"id\":\"376440461742095\"},{\"orderId\":\"376135109050532\",\"id\":\"376440461742100\"},{\"orderId\":\"376135310640540\",\"id\":\"376440461742103\"},{\"orderId\":\"376140150866940\",\"id\":\"376440465936398\"},{\"orderId\":\"376144026143340\",\"id\":\"376440465932303\"},{\"orderId\":\"376149143454564\",\"id\":\"376440465932309\"},{\"orderId\":\"376160732316228\",\"id\":\"376271141879809\"},{\"orderId\":\"376161050821524\",\"id\":\"376440474320912\"},{\"orderId\":\"376161252409588\",\"id\":\"376440474324999\"},{\"orderId\":\"376170353787844\",\"id\":\"376440478519299\"},{\"orderId\":\"376170546988004\",\"id\":\"376440478519301\"},{\"orderId\":\"376171574592692\",\"id\":\"376440478519304\"},{\"orderId\":\"376172275040548\",\"id\":\"376440478515208\"},{\"orderId\":\"376174661599732\",\"id\":\"376440478519311\"},{\"orderId\":\"376179191448964\",\"id\":\"376440482709511\"},{\"orderId\":\"376181192130812\",\"id\":\"376440482713606\"},{\"orderId\":\"376183049945516\",\"id\":\"376440482709514\"},{\"orderId\":\"376185382240940\",\"id\":\"376440482713613\"},{\"orderId\":\"376187148042964\",\"id\":\"376440486907905\"},{\"orderId\":\"376188435431676\",\"id\":\"376440486907908\"},{\"orderId\":\"376188565454884\",\"id\":\"376440486907913\"},{\"orderId\":\"376199374176532\",\"id\":\"376440486907925\"},{\"orderId\":\"376211659294036\",\"id\":\"376440491102213\"},{\"orderId\":\"376213354053796\",\"id\":\"376440491098119\"},{\"orderId\":\"376216185208988\",\"id\":\"376440491102222\"},{\"orderId\":\"376217669992596\",\"id\":\"376440491102224\"},{\"orderId\":\"376220123660540\",\"id\":\"376440495292420\"},{\"orderId\":\"376225274265604\",\"id\":\"376440495296516\"},{\"orderId\":\"376235214766260\",\"id\":\"376440499490820\"},{\"orderId\":\"376236149833836\",\"id\":\"376440499490825\"},{\"orderId\":\"376238297579660\",\"id\":\"376440499486727\"},{\"orderId\":\"376239014543636\",\"id\":\"376440503681028\"},{\"orderId\":\"376241845960716\",\"id\":\"376440503685133\"},{\"orderId\":\"376245419245772\",\"id\":\"376440503681037\"},{\"orderId\":\"376249697435884\",\"id\":\"376440507875339\"},{\"orderId\":\"376249940705308\",\"id\":\"376440507879434\"},{\"orderId\":\"376250905395564\",\"id\":\"376440507875345\"},{\"orderId\":\"376251845181716\",\"id\":\"376440507875348\"},{\"orderId\":\"376252872523892\",\"id\":\"376440512069635\"},{\"orderId\":\"376258925167004\",\"id\":\"376440512073742\"},{\"orderId\":\"376260883644748\",\"id\":\"376440516268034\"},{\"orderId\":\"376261374378124\",\"id\":\"376440516263943\"},{\"orderId\":\"376262670680956\",\"id\":\"376440516268038\"},{\"orderId\":\"376263194706052\",\"id\":\"376440516263953\"},{\"orderId\":\"376264020983876\",\"id\":\"376440520458247\"},{\"orderId\":\"376267867160588\",\"id\":\"376440520458263\"},{\"orderId\":\"374458607993317\",\"id\":\"376271351595008\"},{\"orderId\":\"374803929235469\",\"id\":\"376269334134786\"},{\"orderId\":\"374805112029621\",\"id\":\"376270340771842\"},{\"orderId\":\"376010018130973\",\"id\":\"376440524656646\"},{\"orderId\":\"376077676710477\",\"id\":\"376440524656663\"},{\"orderId\":\"376091928694685\",\"id\":\"376440528846852\"},{\"orderId\":\"376099155739821\",\"id\":\"376269325750274\"},{\"orderId\":\"376116138218229\",\"id\":\"376440533045256\"},{\"orderId\":\"376118734751437\",\"id\":\"376440533041157\"},{\"orderId\":\"376120353755525\",\"id\":\"376440533045263\"},{\"orderId\":\"376123264601765\",\"id\":\"376440537235458\"},{\"orderId\":\"376127693522333\",\"id\":\"376269233475585\"},{\"orderId\":\"376128746554869\",\"id\":\"376440537239557\"},{\"orderId\":\"376135591397573\",\"id\":\"376440537239566\"},{\"orderId\":\"376135834927525\",\"id\":\"376440537239568\"},{\"orderId\":\"376137919497869\",\"id\":\"376355787132935\"},{\"orderId\":\"376138271556461\",\"id\":\"376440537239572\"},{\"orderId\":\"376142059274693\",\"id\":\"376440541429762\"},{\"orderId\":\"376144563275805\",\"id\":\"376440541433866\"},{\"orderId\":\"376145259266797\",\"id\":\"376440541429775\"},{\"orderId\":\"376147490900013\",\"id\":\"376440541429780\"},{\"orderId\":\"376153601738525\",\"id\":\"376440545624067\"},{\"orderId\":\"376155866663197\",\"id\":\"376440545624072\"},{\"orderId\":\"376156973957757\",\"id\":\"376440545624077\"},{\"orderId\":\"376157775331637\",\"id\":\"376440545624079\"},{\"orderId\":\"376160199639933\",\"id\":\"376441225105423\"},{\"orderId\":\"376165547115405\",\"id\":\"376441229295629\"},{\"orderId\":\"376165953962917\",\"id\":\"376441229299723\"},{\"orderId\":\"376171054235781\",\"id\":\"376441233494025\"},{\"orderId\":\"376178524553485\",\"id\":\"376441233489930\"},{\"orderId\":\"376180198081093\",\"id\":\"376441233494028\"},{\"orderId\":\"376182945349989\",\"id\":\"376441233489935\"},{\"orderId\":\"376183800726597\",\"id\":\"376441237688320\"},{\"orderId\":\"376186908967085\",\"id\":\"376441237684227\"},{\"orderId\":\"376190742299237\",\"id\":\"376441237684232\"},{\"orderId\":\"376194781413381\",\"id\":\"376441237688335\"},{\"orderId\":\"376197554110853\",\"id\":\"376441241882628\"},{\"orderId\":\"376198355223877\",\"id\":\"376441241878529\"},{\"orderId\":\"376199252542621\",\"id\":\"376441241878531\"},{\"orderId\":\"376201198960709\",\"id\":\"376441241878542\"},{\"orderId\":\"376210699060437\",\"id\":\"376441246076937\"},{\"orderId\":\"376214083600389\",\"id\":\"376441246072845\"},{\"orderId\":\"376220911927781\",\"id\":\"376441250267138\"},{\"orderId\":\"376226817507605\",\"id\":\"376441250267147\"},{\"orderId\":\"376233797091333\",\"id\":\"376441254465536\"},{\"orderId\":\"376234732159165\",\"id\":\"376271125102596\"},{\"orderId\":\"376236325994941\",\"id\":\"376268830818305\"},{\"orderId\":\"376245461450853\",\"id\":\"376441254461463\"},{\"orderId\":\"376246002516109\",\"id\":\"376441258659842\"},{\"orderId\":\"376248871420269\",\"id\":\"376441258655758\"},{\"orderId\":\"376248992792637\",\"id\":\"376441258655759\"},{\"orderId\":\"376249215090821\",\"id\":\"376441258659857\"},{\"orderId\":\"376252054634661\",\"id\":\"376441262850053\"},{\"orderId\":\"376252151365797\",\"id\":\"376441262850054\"},{\"orderId\":\"376253312926301\",\"id\":\"376356433051650\"},{\"orderId\":\"376254990647829\",\"id\":\"376269560631297\"},{\"orderId\":\"376256567705669\",\"id\":\"376441267048453\"},{\"orderId\":\"376257310097957\",\"id\":\"376441267048457\"},{\"orderId\":\"376257373012149\",\"id\":\"376441267044367\"},{\"orderId\":\"376259767959805\",\"id\":\"376441271238656\"},{\"orderId\":\"376260413882597\",\"id\":\"376441271242752\"},{\"orderId\":\"376264163590357\",\"id\":\"376441271238664\"},{\"orderId\":\"374455936221398\",\"id\":\"376269338333188\"},{\"orderId\":\"375961792020638\",\"id\":\"376441275437074\"},{\"orderId\":\"375989373764182\",\"id\":\"376441275437076\"},{\"orderId\":\"376073754772094\",\"id\":\"376371301863430\"},{\"orderId\":\"376100556639934\",\"id\":\"376441279627270\"},{\"orderId\":\"376100678012166\",\"id\":\"376441279627271\"},{\"orderId\":\"376102246680702\",\"id\":\"376441279627273\"},{\"orderId\":\"376117686175062\",\"id\":\"376441283821568\"},{\"orderId\":\"376119380674070\",\"id\":\"376441283825667\"},{\"orderId\":\"376120726784478\",\"id\":\"376441283825669\"},{\"orderId\":\"376122845168798\",\"id\":\"376441283821578\"},{\"orderId\":\"376123906066454\",\"id\":\"376441283825672\"},{\"orderId\":\"376130176550478\",\"id\":\"376441288015872\"},{\"orderId\":\"376136317273806\",\"id\":\"376441288015882\"},{\"orderId\":\"376140876219294\",\"id\":\"376441288015887\"},{\"orderId\":\"376144420406470\",\"id\":\"376441292210184\"},{\"orderId\":\"376147469664582\",\"id\":\"376441292210188\"},{\"orderId\":\"376156810379670\",\"id\":\"376441296408584\"},{\"orderId\":\"376157670474158\",\"id\":\"376441296404488\"},{\"orderId\":\"376158312202974\",\"id\":\"376441296404489\"},{\"orderId\":\"376159578621974\",\"id\":\"376441300598793\"},{\"orderId\":\"376162015511086\",\"id\":\"376441300598795\"},{\"orderId\":\"376168827060886\",\"id\":\"376270546292736\"},{\"orderId\":\"376169233908510\",\"id\":\"376441300598800\"},{\"orderId\":\"376169741419758\",\"id\":\"376441304793092\"},{\"orderId\":\"376170488266846\",\"id\":\"376441304797189\"},{\"orderId\":\"376172597739710\",\"id\":\"376441304797192\"},{\"orderId\":\"376172887408902\",\"id\":\"376441304797193\"},{\"orderId\":\"376183016391838\",\"id\":\"376441308987399\"},{\"orderId\":\"376200100053006\",\"id\":\"376441833279495\"},{\"orderId\":\"376200754364550\",\"id\":\"376441833275404\"},{\"orderId\":\"376207070724494\",\"id\":\"376441837469703\"},{\"orderId\":\"376211235930158\",\"id\":\"376441841664001\"},{\"orderId\":\"376214163292302\",\"id\":\"376441841664010\"},{\"orderId\":\"376215581229710\",\"id\":\"376441841664013\"},{\"orderId\":\"376234514317686\",\"id\":\"376441850056709\"},{\"orderId\":\"376239345893606\",\"id\":\"376269199917056\"},{\"orderId\":\"376246602301598\",\"id\":\"376441854246917\"},{\"orderId\":\"376249865207870\",\"id\":\"376441854246930\"},{\"orderId\":\"376254025957734\",\"id\":\"376441858441216\"},{\"orderId\":\"376255930433734\",\"id\":\"376441858441226\"},{\"orderId\":\"376255989154294\",\"id\":\"376441858441231\"},{\"orderId\":\"376257662419654\",\"id\":\"376441862635524\"},{\"orderId\":\"376257779859670\",\"id\":\"376441862639622\"},{\"orderId\":\"376260388978862\",\"id\":\"376441862635532\"},{\"orderId\":\"376260862672950\",\"id\":\"376441866833922\"},{\"orderId\":\"376264960508070\",\"id\":\"376441866829841\"},{\"orderId\":\"375121010491479\",\"id\":\"376269338329088\"},{\"orderId\":\"375992561700119\",\"id\":\"376441871024136\"},{\"orderId\":\"376089294669535\",\"id\":\"376441875222533\"},{\"orderId\":\"376096970245319\",\"id\":\"376441875222537\"},{\"orderId\":\"376105031959855\",\"id\":\"376441875222542\"},{\"orderId\":\"376106185130351\",\"id\":\"376270600818690\"},{\"orderId\":\"376117677786303\",\"id\":\"376441879416836\"},{\"orderId\":\"376121070716007\",\"id\":\"376441883607041\"},{\"orderId\":\"376126447815919\",\"id\":\"376441883607049\"},{\"orderId\":\"376131879436527\",\"id\":\"376441887805444\"},{\"orderId\":\"376132680810503\",\"id\":\"376441887805449\"},{\"orderId\":\"376141312691927\",\"id\":\"376441891995661\"},{\"orderId\":\"376141476266943\",\"id\":\"376441891999755\"},{\"orderId\":\"376142960789455\",\"id\":\"376441891995664\"},{\"orderId\":\"376144177399439\",\"id\":\"376441896194054\"},{\"orderId\":\"376148107462271\",\"id\":\"376441896194057\"},{\"orderId\":\"376150280111703\",\"id\":\"376441896194061\"},{\"orderId\":\"376152209490103\",\"id\":\"376441900388352\"},{\"orderId\":\"376165475812327\",\"id\":\"376441904582676\"},{\"orderId\":\"376165693916551\",\"id\":\"376441908776960\"},{\"orderId\":\"376166071402703\",\"id\":\"376441908772866\"},{\"orderId\":\"376169858860487\",\"id\":\"376441908776971\"},{\"orderId\":\"376172505727039\",\"id\":\"376441912971266\"},{\"orderId\":\"376174309279703\",\"id\":\"376441912967174\"},{\"orderId\":\"376174489632815\",\"id\":\"376441912971268\"},{\"orderId\":\"376177706664087\",\"id\":\"376441912967179\"},{\"orderId\":\"376183767171311\",\"id\":\"376441912971273\"},{\"orderId\":\"376185927500447\",\"id\":\"376441917165568\"},{\"orderId\":\"376187894367495\",\"id\":\"376441917161478\"},{\"orderId\":\"376198375933183\",\"id\":\"376441917165580\"},{\"orderId\":\"376202683744879\",\"id\":\"376441917161491\"},{\"orderId\":\"376224443531583\",\"id\":\"376441925554178\"},{\"orderId\":\"376224905167015\",\"id\":\"376441925550083\"},{\"orderId\":\"376227358834815\",\"id\":\"376441925554185\"},{\"orderId\":\"376231448019143\",\"id\":\"376270097502208\"},{\"orderId\":\"376235021829391\",\"id\":\"376441929748489\"},{\"orderId\":\"376235822940247\",\"id\":\"376441929744393\"},{\"orderId\":\"376237576159591\",\"id\":\"376441929748499\"},{\"orderId\":\"376239190966455\",\"id\":\"376441929744401\"},{\"orderId\":\"376241266885103\",\"id\":\"376441933942787\"},{\"orderId\":\"376241719869719\",\"id\":\"376441933938694\"},{\"orderId\":\"376242340626631\",\"id\":\"376441933938703\"},{\"orderId\":\"376248095211951\",\"id\":\"376441938137102\"},{\"orderId\":\"376251186675911\",\"id\":\"376441942331395\"},{\"orderId\":\"376253044752535\",\"id\":\"376441942331404\"},{\"orderId\":\"376253212524687\",\"id\":\"376441942331408\"},{\"orderId\":\"376262947504223\",\"id\":\"376269871009792\"},{\"orderId\":\"376263060750583\",\"id\":\"376441950715908\"},{\"orderId\":\"376263492501591\",\"id\":\"376268067454976\"}]");
        System.out.println(array.size());
        String delCurl = "curl -X POST  http://localhost:8120/maintain/collection/delete -H 'Content-Type: application/json' -d '{\"collectionId\":\"COL\", \"orderId\":\"ORD\"}'";
        for (int i = 0; i < array.size(); i++) {
            String curl = delCurl;
            curl = curl.replaceAll("COL", array.getJSONObject(i).getString("id"));
            curl = curl.replaceAll("ORD", array.getJSONObject(i).getString("orderId"));
            System.out.println(curl);
        }

    }

    @Test
    public void testFindSameRef() throws IOException {
        File file = ResourceUtils.getFile("classpath:input.txt");
        String string = FileUtils.readFileToString(file, "utf-8");
        JSONArray array = JSON.parseArray(string);
        Set<String> all = new HashSet<>();
        Set<String> same = new HashSet<>();
        for (int i = 0; i < array.size(); i++) {
            JSONObject jsonObject = array.getJSONObject(i);
            String orderColl = jsonObject.getString("orderId") + "," + jsonObject.getString("refundNo");
            if(all.contains(orderColl)) {
                same.add(orderColl);
            }
            all.add(orderColl);
        }

        System.out.println(same.size());
        System.out.println(JSON.toJSONString(same));

    }

    @Test
    public void testFindSameColl() throws IOException {
        File file = ResourceUtils.getFile("classpath:input.txt");
        String string = FileUtils.readFileToString(file, "utf-8");
        JSONArray array = JSON.parseArray(string);
        Set<String> all = new HashSet<>();
        Set<String> same = new HashSet<>();
        for (int i = 0; i < array.size(); i++) {
            JSONObject jsonObject = array.getJSONObject(i);
            String orderColl = jsonObject.getString("orderId") + "," + jsonObject.getString("collectionNo");
            if(all.contains(orderColl)) {
                same.add(orderColl);
            }
            all.add(orderColl);
        }

        System.out.println(same.size());
        System.out.println(JSON.toJSONString(same));

    }

    @Test
    public void testFindSameId() throws IOException {
        File file = ResourceUtils.getFile("classpath:ids.txt");
        System.out.println(file);
        List<String> list = FileUtils.readLines(file, "utf-8");
        Set<Long> allId = new HashSet<>();
        Set<Long> sameId = new HashSet<>();
        for (String s : list) {
            Long id = Long.valueOf(s);
            if(allId.contains(id)) {
                sameId.add(id);
            }
            allId.add(id);
        }
        System.out.println(sameId.size());
        System.out.println("(" + StringUtils.join(sameId, ',') + ")");
    }

    @Test
    public void testIdGroup() throws IOException {
        Map<Integer, List<Long>> idGroupMap = readAndGroupId("classpath:ids.txt");

        idGroupMap.forEach((k, v) -> System.out.println(k + "\n (" + StringUtils.join(v, ',') + ")"));
    }

    @Test
    public void testIdsToList() throws IOException {
        List<Long > list = readIdList("classpath:ids.txt");
        System.out.println(list.size());
//        System.out.println("" + StringUtils.join(list, '\n') + "");
        System.out.println("(" + StringUtils.join(list, ',') + ")");
    }

    @Test
    public void testIdsToSet() throws Exception {
        File file = ResourceUtils.getFile("classpath:ids.txt");
        List<String> list = FileUtils.readLines(file, "utf-8");
        System.out.println("list.size:" + list.size());
        Set<Long> set = list.stream().map(id -> Long.valueOf(id)).collect(Collectors.toSet());
        System.out.println("set.size:" + set.size());
        System.out.println("set:" + set);
    }

    @Test
    public void testPhoneToList() throws IOException {
        List<Long > list = readIdList("classpath:ids.txt");
        System.out.println(list.size());
        StringBuilder builder = new StringBuilder();
        builder.append("(");
        list.forEach(e -> {
            builder.append("'").append(e.longValue()).append("'").append(",");
        });
        builder.deleteCharAt(builder.length() - 1);
        builder.append(")");
        System.out.println(builder);
    }

    @Test
    public void testTimeToId() {
        LocalDateTime td = LocalDateTime.of(LocalDate.now(), LocalTime.MIN);
        long nowMaxId = DistributeIdUtils.getMinOrderId(LocalDateTime.now());
        System.out.println("当前id:" + DistributeIdUtils.getMinOrderId(LocalDateTime.now()));
        System.out.println("当天id:" + DistributeIdUtils.getMinOrderId(td));
        System.out.println("最近10天id范围:" + DistributeIdUtils.getMinOrderId(td.minusDays(10)) + ", " + nowMaxId);
        System.out.println("最近30天id范围:" + DistributeIdUtils.getMinOrderId(td.minusDays(30)) + ", " + nowMaxId);
        System.out.println("指定日期id;" + DistributeIdUtils.getMinOrderId(LocalDateTime.parse("20190401_000000", DateTimeFormatter.ofPattern("yyyyMMdd_HHmmss"))));
        System.out.println("指定日期id;" + DistributeIdUtils.getMinOrderId(LocalDateTime.parse("20190501_000000", DateTimeFormatter.ofPattern("yyyyMMdd_HHmmss"))));
        System.out.println("指定日期id;" + DistributeIdUtils.getMinOrderId(LocalDateTime.parse("20190601_000000", DateTimeFormatter.ofPattern("yyyyMMdd_HHmmss"))));
        System.out.println("指定日期id;" + DistributeIdUtils.getMinOrderId(LocalDateTime.parse("20190701_000000", DateTimeFormatter.ofPattern("yyyyMMdd_HHmmss"))));

        long oid = 253908959101262L;
        System.out.println(DistributeIdUtils.getTime(oid));
        System.out.println(oid % 8L);
    }

    /**
     * 提取文本中的订单号
     *
     * @throws Exception
     */
    @Test
    public void testFindId() throws Exception {
        File file = ResourceUtils.getFile("classpath:input.txt");
        String input = FileUtils.readFileToString(file, "utf-8");
//        Pattern pattern = Pattern.compile("\"orderId\":\"(\\d+)\"");
        Pattern pattern = Pattern.compile("\"orderId\":(\\d+)");
        Matcher m = pattern.matcher(input);
        Set<Long> orders = new HashSet<>(100);
        while (m.find()) {
            orders.add(Long.valueOf(m.group(1)));
        }

        System.out.println(orders.size());
        System.out.println(orders);
    }


    public static Map<Integer, List<Long>> readAndGroupId(String resourceLocation) throws IOException {
        return readIdList(resourceLocation).stream().collect(Collectors.groupingBy(id -> (int) (Long.parseLong(String.valueOf(id)) % 8)));
    }

    public static List<Long> readIdList(String resourceLocation) throws IOException {
        File file = ResourceUtils.getFile(resourceLocation);
        System.out.println(file);
        List<String> list = FileUtils.readLines(file, "utf-8");
        System.out.println("srcLines:" + list.size());
        Set<Long> ids = new TreeSet<>();
        for (String id : list) {
            if(id.contains(",")) {
                String[] array = id.split(",");
                for (String e : array) {
                    e = e.trim().replaceAll("\\D+", "");
                    if(StringUtils.isNotBlank(e)) {
                        ids.add(Long.parseLong(e));
                    }
                }
            }
            id = id.trim().replaceAll("\\D+", "");
            if(StringUtils.isNotBlank(id)) {
                ids.add(Long.parseLong(id));
            }
        }
        System.out.println("setSize:" + ids.size());
        return new ArrayList<>(ids);
    }

    public static List<String> readStringList(String resourceLocation) throws IOException {
        File file = ResourceUtils.getFile(resourceLocation);
        System.out.println(file);
        List<String> list = FileUtils.readLines(file, "utf-8");
        System.out.println(list.size());
        ArrayList<String> strings = new ArrayList<>(new HashSet<>(list));
        Collections.sort(strings);
        return strings;
    }
}
